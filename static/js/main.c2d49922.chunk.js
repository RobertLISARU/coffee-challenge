(this["webpackJsonpcoffee-challenge"]=this["webpackJsonpcoffee-challenge"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var o=n(1),c=n.n(o),i=n(7),r=n.n(i),s=(n(13),n(2)),a=n(8),l=n(3),u=(n(14),n(0)),d=function(e){var t=e.isVisible,n=e.name,o=e.distance;return t?Object(u.jsxs)("div",{className:"shopTooltip",children:[Object(u.jsx)("p",{children:n}),Object(u.jsx)("p",{children:o})]}):null},h=n(16),j=function(e,t,n){var o=String.fromCharCode(97+(e+t+n)%3);return"https://".concat(o,".tile.openstreetmap.org/").concat(n,"/").concat(e,"/").concat(t,".png")},b=function(e){var t=e.shops,n=e.userLatitude,c=e.userLongitude,i=Object(o.useState)([]),r=Object(s.a)(i,2),b=r[0],f=r[1],p=Object(o.useState)(!1),g=Object(s.a)(p,2),O=g[0],x=g[1],v=function(e){e.event,e.anchor;var t=e.payload,n=Object(a.a)(b);n[t]=!n[t],f(n)};return Object(u.jsxs)(l.a,{provider:j,defaultCenter:[45.795,24.147],defaultZoom:4,width:600,height:400,children:[t?t.map((function(e){return Object(u.jsx)(l.b,{anchor:[parseFloat(e.x),parseFloat(e.y)],color:"black",payload:e.id,onClick:v},e.id)})):null,t?t.map((function(e){return Object(u.jsx)(l.c,{anchor:[parseFloat(e.x),parseFloat(e.y)],children:Object(u.jsx)(d,{isVisible:b[e.id],name:e.name,distance:Math.round(10*h({latitude:n,longitude:c},{latitude:parseFloat(e.x),longitude:parseFloat(e.y)}))/10+" km"})},e.id)})):null,n&&c?Object(u.jsx)(l.b,{anchor:[n,c],color:"red",payload:"user",onClick:function(e){e.event,e.anchor,e.payload;x(!O)}}):null,n&&c?Object(u.jsx)(l.c,{anchor:[n,c],children:Object(u.jsx)(d,{isVisible:O,name:"Your location",distance:null})}):null]})},f=function(e){var t=e.isLoading,n=e.latitude,o=e.longitude,c=e.error;return t?Object(u.jsx)("div",{children:"Locating..."}):c?Object(u.jsxs)("div",{children:["Error: ",c]}):Object(u.jsxs)("div",{children:["Your location: ",n,", ",o]})},p=function(e){var t=e.isLoading,n=e.shops,o=e.error;return t?Object(u.jsx)("p",{children:"Fetching coffee shop list"}):o?Object(u.jsx)("p",{children:o}):n&&0!==n.length?Object(u.jsxs)("ul",{children:[Object(u.jsx)("h2",{children:"Coffee Shops"}),n.map((function(e){return Object(u.jsxs)("li",{children:[e.name,Object(u.jsx)("br",{}),e.x,Object(u.jsx)("br",{}),e.y,Object(u.jsx)("br",{})]},e.id)}))]}):Object(u.jsx)("p",{children:"No shops"})};var g=function(){var e=Object(o.useState)({latitude:null,longitude:null,isLoading:!1,error:null}),t=Object(s.a)(e,2),n=t[0],c=t[1],i=Object(o.useState)({isLoading:!1,coffeeShops:null,fetchError:null}),r=Object(s.a)(i,2),a=r[0],l=r[1],d=function(e){var t=e.coords;c({latitude:t.latitude,longitude:t.longitude})},h=function(e){c({error:e.message})};return Object(o.useEffect)((function(){var e=navigator.geolocation,t=null;return e?(c({isLoading:!0}),t=e.watchPosition(d,h)):c({error:"Geolocation is not supported"}),l({isLoading:!0}),fetch("https://blue-bottle-api-test.herokuapp.com/v1/tokens",{method:"POST"}).then((function(e){return e.json()})).then((function(e){fetch("https://blue-bottle-api-test.herokuapp.com/v1/coffee_shops?token="+e.token).then((function(e){switch(e.status){case 200:e.json().then((function(e){return l({isLoading:!1,coffeeShops:e})}));break;default:l({isLoading:!1,fetchError:"Could not fetch shop locations "+e.status+": "+e.statusText})}}))})),function(){return e.clearWatch(t)}}),[l]),Object(u.jsxs)("div",{children:[Object(u.jsx)(b,{shops:a.coffeeShops,userLatitude:n.latitude,userLongitude:n.longitude}),Object(u.jsx)(f,{isLoading:n.isLoading,latitude:n.latitude,longitude:n.longitude,error:n.error}),Object(u.jsx)(p,{isLoading:a.isLoading,shops:a.coffeeShops,error:a.fetchError})]})},O=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,18)).then((function(t){var n=t.getCLS,o=t.getFID,c=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),o(e),c(e),i(e),r(e)}))};r.a.render(Object(u.jsx)(c.a.StrictMode,{children:Object(u.jsx)(g,{})}),document.getElementById("root")),O()}},[[17,1,2]]]);
//# sourceMappingURL=main.c2d49922.chunk.js.map